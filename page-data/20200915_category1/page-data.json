{"componentChunkName":"component---src-templates-blog-post-js","path":"/20200915_category1/","result":{"data":{"site":{"siteMetadata":{"title":"amaNekublog"}},"markdownRemark":{"id":"3b74663d-52a4-5544-8b84-96a0eb33ac27","excerpt":"今回はカテゴリ別で記事一覧を表示するページを作っていきます。GatsbyJSの公式サイトに手順が載っていたため、これを参考に進めます。 ＜参考＞ https://www.gatsbyjs.com/docs/adding-tags-and-categories-to-blog-posts/…","html":"<p>今回はカテゴリ別で記事一覧を表示するページを作っていきます。GatsbyJSの公式サイトに手順が載っていたため、これを参考に進めます。</p>\n<p>＜参考＞<br>\n<a href=\"https://www.gatsbyjs.com/docs/adding-tags-and-categories-to-blog-posts/\">https://www.gatsbyjs.com/docs/adding-tags-and-categories-to-blog-posts/</a></p>\n<h2>1. 手順の把握</h2>\n<hr>\n<p>参考サイトから不要な手順を除くと、必要な手順は以下の４つです。</p>\n<ol>\n<li>markdownファイルのfrontmatterに「カテゴリ」を追加する</li>\n<li>クエリを記述して、投稿のすべてのカテゴリを取得する</li>\n<li>カテゴリページテンプレートを作成する（/{category}に）</li>\n<li>そのテンプレートを使用してページをレンダリングするようにgatsby-node.jsを変更する</li>\n</ol>\n<p>今回は手順2. までを解説します。</p>\n<h2>2. 実装</h2>\n<hr>\n<h3>2-1. markdownファイルのfrontmatterに「カテゴリ」を追加する</h3>\n<p>「frontmatter」はmarkdownファイルの先頭の「—-」で囲まれているものです。ここにはタイトルや投稿日といった記事のメタデータを記述します。ここに記事の「カテゴリ」を追加します。</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\ntitle<span class=\"token operator\">:</span> ブログ、始めました。\ndate<span class=\"token operator\">:</span> <span class=\"token string\">\"2020-09-04T00:00:00.000Z\"</span>\ndescription<span class=\"token operator\">:</span> <span class=\"token string\">\"今日からブログを始めます。\"</span>\ncategory<span class=\"token operator\">:</span> <span class=\"token string\">\"Create\"</span>                    <span class=\"token comment\">//★追加</span>\n<span class=\"token operator\">--</span><span class=\"token operator\">-</span></code></pre></div>\n<h3>2-2. クエリを記述して、すべての記事のカテゴリを取得する</h3>\n<p>記事のカテゴリに応じて、その記事をカテゴリ別の記事一覧ページに列挙するかどうかを分別したいです。そのためには2-1. で追加した「カテゴリ」を何らかの手段で取得する必要があります。Gatsbyでは<a href=\"https://graphql.org/\">GraphQL</a>が利用可能です。</p>\n<p>GraphQLはAPI向けに作られたクエリ言語です。例えば、以下のようなクエリでブログ内の情報（メタデータや記事の内容など）を取り出すことができます。※私もまだまだ詳しくないので、詳細は<a href=\"https://graphql.org/\">GraphQLの公式サイト</a>を参照して下さい。</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> Query <span class=\"token punctuation\">{</span>\n  site <span class=\"token punctuation\">{</span>\n    siteMetadata <span class=\"token punctuation\">{</span>\n      title\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>自分のサイトでのGraphQLでのクエリ結果を確かめるために、<strong>GraphiQL</strong>が利用できます。<code class=\"language-text\">gatsby develop</code>で開発用サーバーを実行中に、<code class=\"language-text\">http://localhost:8000/___graphql</code> から利用できます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/amaNekublog/static/f9a6437ab6b533ca0ec8ddc9d87a3feb/71ee9/graphiql.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAABv0lEQVQ4y52U3XLjIAyF/f7Pt1ftVTNjO8bYxvzbGJ+V6OLNTNLubDWjIAj5dAQizb4nhBCxaoP+PqAjH+WEcZogRolpWSieS8wuKZ4XVfbMywoTDG6/BgxvCmxN+TxP9H0PbQyFJ46csW1bWXt7f0dH48fthjsl4zUxjpT8jmEQZT6KEV3XFzHNbAK026C0w3EcqBZCwDzPkELAzgus1mVN0yhJnZoWrOuKRSkoGlk1e9NKC+23C8QK2WKMcM4iEkSOGtpGZPrqyAeM0hjvlEwZWBfgfUSIW/Gmmx32dFywCmR1irKzarclxP1zz77vsN5DUkUfA52vUNAEt4uBo7topKIMIT0B27aFogtJKeHR0pFofYUllcF6qsKTwgDnmUNAKwLylp+AXdfReZlrXkdOoFcNOzHUwDhXQOwMbewUcebzC6BGzvkJWCDUBT7+BfmqcO09UsxfAl8pNNZdoFrqVfLUWni90y9+BqzlVm+E8tj24+Wl/Aho//RghT0qNMb8P/AmVoQXCq211BLu9aX8q+TatI/Gb9lTA1dQNW70b4GSOly7WDZydnaO+Z3ySxH0lofh80+B53yu3wF/A5d3jKkmyysOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"GraphiQL\"\n        title=\"GraphiQL\"\n        src=\"/amaNekublog/static/f9a6437ab6b533ca0ec8ddc9d87a3feb/fcda8/graphiql.png\"\n        srcset=\"/amaNekublog/static/f9a6437ab6b533ca0ec8ddc9d87a3feb/12f09/graphiql.png 148w,\n/amaNekublog/static/f9a6437ab6b533ca0ec8ddc9d87a3feb/e4a3f/graphiql.png 295w,\n/amaNekublog/static/f9a6437ab6b533ca0ec8ddc9d87a3feb/fcda8/graphiql.png 590w,\n/amaNekublog/static/f9a6437ab6b533ca0ec8ddc9d87a3feb/efc66/graphiql.png 885w,\n/amaNekublog/static/f9a6437ab6b533ca0ec8ddc9d87a3feb/71ee9/graphiql.png 1081w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>一番左が探索できるデータになります。ここから目的のデータを選択すると、真ん中にそれを取得するためのクエリが勝手に出力されます。もちろん自分でクエリを記述することもできます。一番右がクエリの結果です。</p>\n<p>さて、すべての記事のカテゴリを取得するためのクエリですが、以下で取得できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token punctuation\">{</span>\n  allMarkdownRemark<span class=\"token punctuation\">(</span><span class=\"token attr-name\">sort</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token attr-name\">fields</span><span class=\"token punctuation\">:</span> frontmatter___date<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    edges <span class=\"token punctuation\">{</span>\n      node <span class=\"token punctuation\">{</span>\n        frontmatter <span class=\"token punctuation\">{</span>\n          category\n          title\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>結果</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/amaNekublog/static/020dd36fc7acbc15745eefc9aeb9f915/236d7/queryCategory.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABK0lEQVQoz42SiXLDIAxE/f+f2SYTHxy2kRDxtRU09EjTNp7ZWQ2G5Ul2czqd0LYthr6HP59h1a21MGaAU2+7Ds45eO+L38vefBgMut6gISL4IJg5IaUFi6yQ6wq+bkjLBmbWyxx6N2OcCcTxTzVJBJxWXBxh0QAcwL4f2FRaIkmCHwPO/QijzhQRY0KUx2oywXHsWLddPUfU572WlDcK7ES4mAlkZ5DX4CgPVVr+DDpKXVUD58BwGhi0pXwoZlWqdEeYdKFEfQn5Fpg3akCvVK+tR9DWSefJE4P1okxLI4FnLuP4EfiQkLhQ8o2stldqvmv5GcK8Mc/vpXUInVdCpdIRlFnmi260HOL/gfl90A9HGkqZRg/l1goZV5cP0icIBZPxhYhFfv1dqt4AJGwI8H4vzP8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Query Category\"\n        title=\"Query Category\"\n        src=\"/amaNekublog/static/020dd36fc7acbc15745eefc9aeb9f915/fcda8/queryCategory.png\"\n        srcset=\"/amaNekublog/static/020dd36fc7acbc15745eefc9aeb9f915/12f09/queryCategory.png 148w,\n/amaNekublog/static/020dd36fc7acbc15745eefc9aeb9f915/e4a3f/queryCategory.png 295w,\n/amaNekublog/static/020dd36fc7acbc15745eefc9aeb9f915/fcda8/queryCategory.png 590w,\n/amaNekublog/static/020dd36fc7acbc15745eefc9aeb9f915/efc66/queryCategory.png 885w,\n/amaNekublog/static/020dd36fc7acbc15745eefc9aeb9f915/c83ae/queryCategory.png 1180w,\n/amaNekublog/static/020dd36fc7acbc15745eefc9aeb9f915/236d7/queryCategory.png 1486w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>全てのMarkdownファイルを日付順でソートし、そのカテゴリとタイトルが取得できました。</p>\n<p>本日はここまでです。次回、続きを解説します。</p>","frontmatter":{"title":"【GatsbyJS】カテゴリ別の記事一覧ページを作る①","date":"2020.09.15","description":null,"category":"Develop"}}},"pageContext":{"slug":"/20200915_category1/","previous":{"fields":{"slug":"/20200906_typography/"},"frontmatter":{"title":"Typography.jsを使ってGatsby製ブログのテキスト周りをアレンジする"}},"next":{"fields":{"slug":"/20200917_category2/"},"frontmatter":{"title":"【GatsbyJS】カテゴリ別の記事一覧ページを作る②"}}}},"staticQueryHashes":["1317458740","2228689422","2841359383","3644837815"]}